<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>DAPP_EX1</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="" name="keywords">
  <meta content="" name="description">

  <!-- Favicons -->
  <link href="img/favicon.png" rel="icon">
  <link href="img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,600,700|Raleway:300,400,400i,500,500i,700,800,900" rel="stylesheet">

  <!-- Bootstrap CSS File -->
  <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Libraries CSS Files -->
  <link href="lib/nivo-slider/css/nivo-slider.css" rel="stylesheet">
  <link href="lib/owlcarousel/owl.carousel.css" rel="stylesheet">
  <link href="lib/owlcarousel/owl.transitions.css" rel="stylesheet">
  <link href="lib/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="lib/animate/animate.min.css" rel="stylesheet">
  <link href="lib/venobox/venobox.css" rel="stylesheet">

  <!-- Nivo Slider Theme -->
  <link href="css/nivo-slider-theme.css" rel="stylesheet">

  <!-- Main Stylesheet File -->
  <link href="css/style.css" rel="stylesheet">

  <!-- Responsive Stylesheet File -->
  <link href="css/responsive.css" rel="stylesheet">
  <script src="web3/dist/web3.min.js"></script>

</head>

<body data-spy="scroll" data-target="#navbar-example">

  <div id="preloader"></div>

  <header>
    <!-- header-area start -->
    <div id="sticker" class="header-area">
      <div class="container">
        <div class="row">
          <div class="col-md-12 col-sm-12">

            <!-- Navigation -->
            <nav class="navbar navbar-default">
              <!-- Brand and toggle get grouped for better mobile display -->
              <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".bs-example-navbar-collapse-1" aria-expanded="false">
										<span class="sr-only">Toggle navigation</span>
										<span class="icon-bar"></span>
										<span class="icon-bar"></span>
										<span class="icon-bar"></span>
									</button>
                <!-- Brand -->
                <a class="navbar-brand page-scroll sticky-logo" href="index.html">
                  <h1>RealEstate</h1>
                  <!-- Uncomment below if you prefer to use an image logo -->
                  <!-- <img src="img/logo.png" alt="" title=""> -->
								</a>
              </div>
              <!-- Collect the nav links, forms, and other content for toggling -->
              <div class="collapse navbar-collapse main-menu bs-example-navbar-collapse-1" id="navbar-example">
                <ul class="nav navbar-nav navbar-right">
                  <li class="active">
                    <a class="page-scroll" href="#home">Home</a>
                  </li>
                  <li>
                    <a class="page-scroll" href="#about">About</a>
                  </li>
                  <li>
                    <a class="page-scroll" href="#services">Services</a>
                  </li>

                </ul>
              </div>
              <!-- navbar-collapse -->
            </nav>
            <!-- END: Navigation -->
          </div>
        </div>
      </div>
    </div>
    <!-- header-area end -->
  </header>
  <!-- header end -->



  <!-- Start About area -->
  <div id="about" class="about-area area-padding">
    <div class="container">
      <div class="row">
        <div class="col-md-12 col-sm-12 col-xs-12">
          <div class="section-headline text-center">
            <h2><br>History of House (id823525)</h2>
          </div>
        </div>
      </div>
      <div class="row">
        <!-- single-well start-->
        <div class="col-md-6 col-sm-6 col-xs-12">
          <div class="well-left">
            <div class="single-well">
              <a href="#">
								  <img class="img-fluid" src="img/house.jpg" alt="">
								</a>
            </div>
          </div>
        </div>
          
          
        <!-- single-well end-->
        <div class="col-md-6 col-sm-6 col-xs-12">
          <div class="well-middle">
            <div class="single-well">
              <a href="#">
                <h4 class="sec-head">Record / Check History</h4>
              </a>

                <br>

                
                  <div class="col-md-12">

                <div class="input-group">

  <input id="addrecord" type="text" class="form-control" placeholder="Add History">
                      <span class="input-group-btn">
    <input class="btn btn-default" type="button" id="recordbutton" value="Record">
  </span>
</div>
                </div>   
                
                
                
                
                

  <div class="col-md-12">
                <br><input type="button" class="btn-info" value="Show History" id="showhistory">
                </div>
            </div>
          </div>
        </div>
        <!-- End col-->
      </div>
    </div>
  </div>
  <!-- End About area -->


  <!-- End Blog -->
 
  <!-- Start Footer bottom Area -->
  <footer>
    <div class="footer-area">
      <div class="container">
        <div class="row">
            
            
            
            
            
            <div class="footer-content">
                <h3 id="visiblehead">Record</h3>
              <div class="footer-head">
                <table class="table table-hover table-primary table-responsive" id="tablehistory">
                  </table>

              </div>
            </div>
              
              
              
              
              
              


        </div>
      </div>
    </div>
      
      
      
      
      
      
      
      
      
      
      
    <div class="footer-area-bottom">
      <div class="container">
        <div class="row">
          <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="copyright text-center">
              <p>
                &copy; 2018 All CopyRights Reserved by JHY
              </p>
            </div>
            <div class="credits">
              <!--
                All the links in the footer should remain intact.
                You can delete the links only if you purchased the pro version.
                Licensing information: https://bootstrapmade.com/license/
                Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/buy/?theme=eBusiness
              -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <a href="#" class="back-to-top"><i class="fa fa-chevron-up"></i></a>

  <!-- JavaScript Libraries -->
  <script src="lib/jquery/jquery.min.js"></script>
  <script src="lib/bootstrap/js/bootstrap.min.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>
  <script src="lib/venobox/venobox.min.js"></script>
  <script src="lib/knob/jquery.knob.js"></script>
  <script src="lib/wow/wow.min.js"></script>
  <script src="lib/parallax/parallax.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/nivo-slider/js/jquery.nivo.slider.js" type="text/javascript"></script>
  <script src="lib/appear/jquery.appear.js"></script>
  <script src="lib/isotope/isotope.pkgd.min.js"></script>

  <!-- Contact Form JavaScript File -->
  <script src="contactform/contactform.js"></script>

  <script src="js/main.js"></script>
</body>
      <script>

          
          
        if(typeof(web3) !== 'undefined')
        {
            web3=new Web3(web3.currentProvider);
        }
        else
        {
            web3=new Web3(new Web3.providers.HttpProvider('http://localhost:7545'));    
        }
        web3.eth.defaultAccount=web3.eth.accounts[0];
        
    var valueContract=web3.eth.contract([
	{
		"constant": true,
		"inputs": [
			{
				"name": "mynum",
				"type": "uint8"
			}
		],
		"name": "getRecordDescription",
		"outputs": [
			{
				"name": "",
				"type": "bytes32"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "mylength",
		"outputs": [
			{
				"name": "",
				"type": "uint8"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "getRecordSize",
		"outputs": [
			{
				"name": "",
				"type": "uint8"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "mynum",
				"type": "uint8"
			}
		],
		"name": "getRecordDateTime",
		"outputs": [
			{
				"name": "",
				"type": "bytes32"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "mydesc",
				"type": "bytes32"
			},
			{
				"name": "mydate",
				"type": "bytes32"
			}
		],
		"name": "setRecord",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "uint8"
			}
		],
		"name": "realEstateRecord",
		"outputs": [
			{
				"name": "description",
				"type": "bytes32"
			},
			{
				"name": "datetime",
				"type": "bytes32"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "constructor"
	}
]);
        //0xbdea8aaced90f896f2cf4e5d1c10ebaa3ec3576f
        
        //change contract address
        var ContractInstance=valueContract.at("0x379a49ffc75b26ce165ad0a69225d3cf27fc88df");
        
          
          //console.log(new Date().toLocaleTimeString());
          //console.log(new Date().toISOString());
          //console.log(new Date().toUTCString());
          //console.log(new Date().toLocaleDateString());
          
          var mytable=document.getElementById("tablehistory");
          mytable.style.visibility="hidden";
          document.getElementById("visiblehead").style.visibility="hidden";

        function showmytable()
        {
          var rows=mytable.insertRow(0);
          var c1=rows.insertCell(0);
          var c2=rows.insertCell(1);
          var c3=rows.insertCell(2);
          c1.innerHTML="Number";
          c2.innerHTML="Description";
          c3.innerHTML="Date(UTC)";
        }
          
          
          
        function tablecomponents()
        {
          while(mytable.firstChild)
          {
                mytable.removeChild(mytable.firstChild);
          }
          showmytable();
          for(var i=0;i<ContractInstance.getRecordSize();i++)
          {
              

              
              
              
              var rows=mytable.insertRow(i+1);
              var c1=rows.insertCell(0);
              var c2=rows.insertCell(1);
              var c3=rows.insertCell(2);
              var numRows=i+1;
              c1.innerHTML=numRows.toString();
              //c2.innerHTML=web3.toAscii(ContractInstance.getRecordDescription(i));
              //c3.innerHTML=web3.toAscii(ContractInstance.getRecordDateTime(i));
              c2.innerHTML=web3.toUtf8(ContractInstance.getRecordDescription(i));
              c3.innerHTML=web3.toUtf8(ContractInstance.getRecordDateTime(i));
              //console.log(web3.toUtf8(ContractInstance.getRecordDescription(i)));
          }
        

          document.getElementById("addrecord").value="";
        }
          
        function initializeTable()
        {
          if(ContractInstance.getRecordSize()>0)
          {
            document.getElementById("visiblehead").style.visibility="visible";
            mytable.style.visibility="visible";            
          }
        }
        
        $( "#showhistory" ).click(function(){
                    
          initializeTable();
          tablecomponents();

        
        });
          

        $( "#recordbutton" ).click(function() {

            
            //initializeTable(); 
            //web3.toAscii()
            //document.getElementById("addrecord").value
            //new Date().toLocaleTimeString()
            
            
          
          var houseDescription=document.getElementById("addrecord").value;
          var houseDate=new Date().toUTCString();
          
            
            var checkifstring=false;
            try{
                var numdesc=parseInt(houseDescription);
                if(!isNaN(numdesc))
                {
                   alert("You cannot enter numeric value");
                }
                else
                {
                    checkifstring=true;
                }
            }catch(NumericParseErr)
            {
                
            }
            
            if(checkifstring)
            {
                  if(houseDescription.length > 32)
                  {
                    alert("Input length should be less than 33");  
                  }
                  else if(houseDescription.length <= 0)
                  {
                    alert("You cannot leave input emptry"); 
                  }
                  else
                  {
                      initializeTable();
                      ContractInstance.setRecord(houseDescription, houseDate);    
                      alert("Successfully added");
                      tablecomponents();
                  }
            }
            

          


            
          
        });

      </script>
</html>
